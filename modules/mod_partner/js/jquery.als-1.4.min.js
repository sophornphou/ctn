/*jquery.als v.1.4 | (c) 2012, 2014 Federica Sibella musings(at)musings(dot)it | http://www.musings.it | MIT or GPLv3 license.*/
(function(c){function p(f){if("string"===typeof f){var a=f.indexOf("_");-1!=a&&(f=f.substr(a+1))}return f}function q(f){f.preventDefault();f=p(c(this).attr("data-id"));var a=l[f];c(this).off();a.prev.off();c.fn.als("next",f)}function s(f){f.preventDefault();f=p(c(this).attr("data-id"));var a=l[f];c(this).off();a.next.off();c.fn.als("prev",f)}var l=[],k=0,u={init:function(f){this.each(function(){var a=c(this),b=a.data("als"),d=c(),b=c(),m=c(),e=c(),g=c(),h=c(),v=0,n=0,p=0,w=0,A=0,x=0,B=0,C=0,y=0,D=
0,u=0,G,H,I,E,F,z,d=c.extend({visible_items:3,scrolling_items:1,orientation:"horizontal",circular:"no",autoscroll:"no",interval:4E3,speed:600,easing:"swing",direction:"left",start_from:0},f);"no"==d.circular&&"yes"==d.autoscroll&&(d.circular="yes");if("linear"!=d.easing||"swing"!=d.easing)d.easing="swing";a.attr("id")&&""!=a.attr("id")||a.attr("id","als-container_"+k);a.attr("data-id","als-container_"+k);e=a.find(".als-viewport").attr("id","als-viewport_"+k);m=a.find(".als-wrapper").attr("id","als-wrapper_"+
k);b=a.find(".als-item");v=b.size();d.visible_items>v&&(d.visible_items=v-1);d.scrolling_items>d.visible_items&&(d.scrolling_items=d.visible_items-1);d.start_from>v-d.visible_items&&(d.start_from=0);g=a.find(".als-prev").attr("data-id","als-prev_"+k);h=a.find(".als-next").attr("data-id","als-next_"+k);switch(d.orientation){default:b.each(function(a){c(this).attr("id","als-item_"+k+"_"+a);p+=c(this).outerWidth(!0);c(this).outerHeight(!0)>B&&(B=c(this).outerHeight(!0));y<d.visible_items&&(0==d.start_from?
(n+=c(this).outerWidth(!0),y++):a>=d.start_from&&(n+=c(this).outerWidth(!0),y++));0!=d.start_from&&(D<d.start_from&&(x+=c(this).outerWidth(!0),D++),u=d.start_from)});m.css("width",p);b.css("left",-x);e.css("width",n);m.css("height",B);e.css("height",B);if("yes"==d.circular&&0!=d.start_from)for(r=0;r<d.start_from;r++){var t=b.last().position(),t=t.left+b.last().outerWidth(!0);b.eq(r).css("left",t)}break;case "vertical":if(b.each(function(a){c(this).attr("id","als-item_"+k+"_"+a);A+=c(this).outerHeight(!0);
c(this).outerWidth(!0)>C&&(C=c(this).outerWidth(!0));y<d.visible_items&&(0==d.start_from?(w+=c(this).outerHeight(!0),y++):a>=d.start_from&&(w+=c(this).outerHeight(!0),y++));0!=d.start_from&&(D<d.start_from&&(x+=c(this).outerHeight(!0),D++),u=d.start_from)}),m.css("height",A),b.css("top",-x),e.css("height",w),m.css("width",C),e.css("width",C),"yes"==d.circular&&0!=d.start_from)for(r=0;r<d.start_from;r++)t=b.last().position(),t=t.top+b.last().outerHeight(!0),b.eq(r).css("top",t)}"no"==d.circular&&(0==
d.start_from&&g.css("display","none"),d.visible_items+d.start_from==v&&h.css("display","none"));e.on("touchstart",function(a){a.preventDefault();a=void 0==a.originalEvent.touches?a:a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];G=a.pageX;H=a.pageY;I=(new Date).getTime()});e.on("touchmove",function(a){a.preventDefault()});e.on("touchend",function(a){a.preventDefault();a=void 0==a.originalEvent.touches?a:a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];E=a.pageX-G;F=a.pageY-
H;z=(new Date).getTime()-I;"horizontal"==d.orientation?-100>E&&300>z?h.trigger("click"):100<E&&300>z&&g.trigger("click"):-100>F&&300>z?h.trigger("click"):100<F&&300>z&&g.trigger("click")});a.data("als",{container:a,instance:k,options:d,viewport:e,wrapper:m,prev:g,next:h,item:b,num_items:v,wrapper_width:p,viewport_width:n,wrapper_height:A,viewport_height:w,current:u,timer:0});b=a.data("als");l[k]=b;h.on("click touchstart touchend",q);g.on("click touchstart touchend",s);"yes"==d.autoscroll?(c.fn.als("start",
k),m.hover(function(){c.fn.als("stop",c(this).attr("id"))},function(){c.fn.als("start",c(this).attr("id"))})):"no"==d.autoscroll&&c.fn.als("stop",k);k++;return l})},next:function(f){f=p(f);var a=l[f],b=0,b=0;switch(a.options.orientation){default:var d=0,c=0;switch(a.options.circular){default:for(b=a.current;b<a.current+a.options.scrolling_items;b++)d+=a.item.eq(b).outerWidth(!0);a.current+=a.options.scrolling_items;for(b=a.current;b<a.current+a.options.visible_items;b++)c+=a.item.eq(b).outerWidth(!0);
a.viewport.animate({width:c},a.options.speed,a.options.easing);a.item.animate({left:"-="+d},a.options.speed,a.options.easing);a.item.promise().done(function(){a.next.on("click",q);a.prev.on("click",s)});0<a.current&&a.prev.show();a.current+a.options.visible_items>=a.num_items&&a.next.hide();break;case "yes":for(var e=0,g=[],b=a.current;b<a.current+a.options.scrolling_items;b++){var h=b;b>=a.num_items&&(h=b-a.num_items);d+=a.item.eq(h).outerWidth(!0);g[e]=h;e++}a.current+=a.options.scrolling_items;
a.current>=a.num_items&&(a.current-=a.num_items);for(b=a.current;b<a.current+a.options.visible_items;b++)e=b,b>=a.num_items&&(e=b-a.num_items),c+=a.item.eq(e).outerWidth(!0);a.viewport.animate({width:c},a.options.speed,a.options.easing);a.item.animate({left:"-="+d},a.options.speed,a.options.easing);a.item.promise().done(function(){var b=a.item.last().position(),b=b.left+a.item.last().outerWidth(!0);for(k5=0;k5<g.length;k5++)0==g[k5]&&(b=a.item.last().position(),b=b.left+a.item.last().outerWidth(!0)),
a.item.eq(g[k5]).css("left",b);a.next.on("click",q);a.prev.on("click",s)})}break;case "vertical":switch(c=d=0,a.options.circular){default:for(b=a.current;b<a.current+a.options.scrolling_items;b++)d+=a.item.eq(b).outerHeight(!0);a.current+=a.options.scrolling_items;for(b=a.current;b<a.current+a.options.visible_items;b++)c+=a.item.eq(b).outerHeight(!0);a.viewport.animate({height:c},a.options.speed,a.options.easing);a.item.animate({top:"-="+d},a.options.speed,a.options.easing);a.item.promise().done(function(){a.next.on("click",
q);a.prev.on("click",s)});0<a.current&&a.prev.show();a.current+a.options.visible_items>=a.num_items&&a.next.hide();break;case "yes":e=0;g=[];for(b=a.current;b<a.current+a.options.scrolling_items;b++)h=b,b>=a.num_items&&(h=b-a.num_items),d+=a.item.eq(h).outerHeight(!0),g[e]=h,e++;a.current+=a.options.scrolling_items;a.current>=a.num_items&&(a.current-=a.num_items);for(b=a.current;b<a.current+a.options.visible_items;b++)e=b,b>=a.num_items&&(e=b-a.num_items),c+=a.item.eq(e).outerHeight(!0);a.viewport.animate({height:c});
a.item.animate({top:"-="+d});a.item.promise().done(function(){var b=a.item.last().position(),b=b.top+a.item.last().outerHeight(!0);for(k5=0;k5<g.length;k5++)0==g[k5]&&(b=a.item.last().position(),b=b.top+a.item.last().outerHeight(!0)),a.item.eq(g[k5]).css("top",b);a.next.on("click",q);a.prev.on("click",s)})}}l[f]=a;return l},prev:function(c){c=p(c);var a=l[c],b=0,b=0;switch(a.options.orientation){default:var d=0,m=0;switch(a.options.circular){default:a.current-=a.options.scrolling_items;for(b=a.current;b<
a.current+a.options.scrolling_items;b++)d+=a.item.eq(b).outerWidth(!0);for(b=a.current;b<a.current+a.options.visible_items;b++)m+=a.item.eq(b).outerWidth(!0);a.viewport.animate({width:m});a.item.animate({left:"+="+d},a.options.speed,a.options.easing);a.item.promise().done(function(){a.prev.on("click",s);a.next.on("click",q)});0>=a.current&&a.prev.hide();a.current+a.options.visible_items<a.num_items&&a.next.show();break;case "yes":var e=0,g=[];a.current-=a.options.scrolling_items;0>a.current&&(a.current+=
a.num_items);for(b=a.current;b<a.current+a.options.scrolling_items;b++){var h=b;b>=a.num_items&&(h=b-a.num_items);d+=a.item.eq(h).outerWidth(!0);g[e]=h;e++}for(b=a.current;b<a.current+a.options.visible_items;b++)e=b,b>=a.num_items&&(e=b-a.num_items),m+=a.item.eq(e).outerWidth(!0);b=a.item.first().position();b=b.left-a.wrapper_width;for(k5=0;k5<g.length;k5++)if(a.item.eq(g[k5]).css("left",b),0==g[k5])for(e=a.item.eq(0).position(),e=e.left-a.wrapper_width,k6=0;k6<k5;k6++)a.item.eq(g[k6]).css("left",
e);setTimeout(function(){a.viewport.animate({width:m});a.item.animate({left:"+="+d},a.options.speed,a.options.easing);a.item.promise().done(function(){a.prev.on("click",s);a.next.on("click",q)})},200)}break;case "vertical":var k=0,n=0;switch(a.options.circular){default:a.current-=a.options.scrolling_items;for(b=a.current;b<a.current+a.options.scrolling_items;b++)k+=a.item.eq(b).outerHeight(!0);for(b=a.current;b<a.current+a.options.visible_items;b++)n+=a.item.eq(b).outerHeight(!0);a.viewport.animate({height:n});
a.item.animate({top:"+="+k},a.options.speed,a.options.easing);a.item.promise().done(function(){a.prev.on("click",s);a.next.on("click",q)});0>=a.current&&a.prev.hide();a.current+a.options.visible_items<a.num_items&&a.next.show();break;case "yes":e=0;g=[];a.current-=a.options.scrolling_items;0>a.current&&(a.current+=a.num_items);for(b=a.current;b<a.current+a.options.scrolling_items;b++)h=b,b>=a.num_items&&(h=b-a.num_items),k+=a.item.eq(h).outerHeight(!0),g[e]=h,e++;for(b=a.current;b<a.current+a.options.visible_items;b++)e=
b,b>=a.num_items&&(e=b-a.num_items),n+=a.item.eq(e).outerHeight(!0);b=a.item.first().position();b=b.top-a.wrapper_height;for(k5=0;k5<g.length;k5++)if(a.item.eq(g[k5]).css("top",b),0==g[k5])for(e=a.item.eq(0).position(),e=e.top-a.wrapper_height,k6=0;k6<k5;k6++)a.item.eq(g[k6]).css("top",e);setTimeout(function(){a.viewport.animate({height:n},a.options.speed,a.options.easing);a.item.animate({top:"+="+k},a.options.speed,a.options.easing);a.item.promise().done(function(){a.prev.on("click",s);a.next.on("click",
q)})},200)}}l[c]=a;return l},start:function(f){f=p(f);var a=l[f];0!=a.timer&&clearInterval(a.timer);switch(a.options.direction){default:a.timer=setInterval(function(){a.next.off();a.prev.off();c.fn.als("next",f)},a.options.interval);break;case "right":case "down":a.timer=setInterval(function(){a.prev.off();a.next.off();c.fn.als("prev",f)},a.options.interval)}l[f]=a;return l},stop:function(c){c=p(c);var a=l[c];clearInterval(a.timer);l[c]=a;return l},destroy:function(){id=p(c(this).attr("data-id"));
var f=l[id];f.prev.off();f.next.off();c.fn.als("stop",id);c.removeData(f,this.name);this.removeClass(this.name);this.unbind();this.element=null}};c.fn.als=function(f){if(u[f])return u[f].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof f&&f)c.error("Method "+f+" does not exist on jQuery.als");else return u.init.apply(this,arguments)}})(jQuery);

